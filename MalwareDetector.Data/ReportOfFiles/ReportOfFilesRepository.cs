using MalwareDetector.Core.Domains.ReportOfFiles;
using MalwareDetector.Core.Domains.ReportOfFiles.Repositories;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

namespace MalwareDetector.Data.ReportOfFiles
{
    public class ReportOfFilesRepository : IReportOfFilesRepository
    {
        private static List<ReportOfFilesModel> _listOfReports = new List<ReportOfFilesModel>();
        /// <summary>
        /// Создание нового отчета
        /// </summary>
        /// <param name="report">Обьект шаблона отчета для бизнес логики</param>
        /// <returns>Индетификатор отчета</returns>
        public Guid CreateAReport(ReportOfFilesTemplate report)
        {
            var entity = new ReportOfFilesModel()
            {
                Id = Guid.NewGuid(),
                FileName = report.FileName,
                MalwareType = report.MalwareType,
                ScanReportId = report.ScanReportId
            };

            _listOfReports.Add(entity);
            return entity.Id;
        }
        /// <summary>
        /// Получение коллекции отчетов с помощью индетификатора
        /// </summary>
        /// <param name="id">Индетификатора отчета</param>
        /// <returns>Коллекция отчетов</returns>
        public List<ReportOfFilesTemplate> GetAReportByScannerId(Guid id)
        {
            return new List<ReportOfFilesTemplate>(_listOfReports
            .Where(x => x.ScanReportId == id)
            .Select(x => new ReportOfFilesTemplate()
            {
                Id = x.Id,
                FileName = x.FileName,
                MalwareType = x.MalwareType,
                ScanReportId = x.ScanReportId
            }));
        }
    }
}
