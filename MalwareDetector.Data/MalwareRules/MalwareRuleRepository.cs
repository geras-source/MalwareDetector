using MalwareDetector.Core.Domains.MalwaresRules;
using MalwareDetector.Core.Domains.MalwaresRules.Repositories;
using System.Collections.Generic;
using System.Linq;

namespace MalwareDetector.Data.MalwareRules
{
    /// <summary>
    /// Реализация репозитория по правилам сканирования
    /// </summary>
    public class MalwareRuleRepository : IMalwareRuleRepository
    {
        /// <summary>
        /// Коллекция malware'ов
        /// </summary>
        private readonly MalwaresModel[] _malwares = new MalwaresModel[]
        {
            new MalwaresModel()
            {
                Name = "JS",
                Malware = "<script>evil_script()</script>",
                Extension = ".js"
            },
            new MalwaresModel()
            {
                Name = "rm -rf",
                Malware = @"rm -rf %userprofile%\Documents",
                Extension = "*"
            },
            new MalwaresModel()
            {
                Name = "Rundll32",
                Malware = "Rundll32 sus.dll SusEntry",
                Extension = "*"
            }
        };
        /// <summary>
        /// Реализация метода получения всех правил из коллекции
        /// </summary>
        /// <returns>Коллекция правил</returns>
        public List<MalwaresTemplate> GetMalwareRules()
        {
            return new List<MalwaresTemplate>(_malwares.Select(x => new MalwaresTemplate()
            {
                Name = x.Name,
                Malware = x.Malware,
                Extension = x.Extension
            }));
        }
    }
}